##1.CPU多级缓存
左图为最简单的高速缓存的配置，数据的读取和存储都经过高速缓存，CPU核心与高速缓存有一条特殊的快速通道；主存与高速缓存都连在系统总线上（BUS）这条总线还用于其他组件的通信
在高速缓存出现后不久，系统变得越来越复杂，高速缓存与主存之间的速度差异被拉大，直到加入了另一级缓存，新加入的这级缓存比第一缓存更大，并且更慢，而且经济上不合适，所以有了二级缓存，甚至是三级缓存。
![cup缓存](https://upload-images.jianshu.io/upload_images/7220971-355d4c8c7f48e280.png)

* 为什么需要CPU cache？
> CPU的频率太快了，快到主存跟不上，这样在处理器时钟周期内，CPU常常需要等待主存，浪费资源，
所以cache的出现，是为了缓解CPU和内存之间速度的不匹配问题（结构：cpu->cache->memort）

* CPU cache有什么意义？
> 1.时间局部性：如果某个数据被访问，那么在不久的将来他很可能被再次访问
2.空间局部性：如果某个数据被访问，那么与他相邻的数据很快也可能被访问

* 缓存一致性（MESI）
> M: Modified 修改，指的是该缓存行只被缓存在该CPU的缓存中，并且是被修改过的，因此他与主存中的数据是不一致的，
      该缓存行中的数据需要在未来的某个时间点（允许其他CPU读取主存相应中的内容之前）写回主存，然后状态变成E（独享）
  E：Exclusive 独享 缓存行只被缓存在该CPU的缓存中，是未被修改过的，与主存的数据是一致的，可以在任何时刻当有其他CPU读取该内存时，变成S（共享）状态，当CPU修改该缓存行的内容时，变成M（被修改）的状态
  S：Share 共享，意味着该缓存行可能会被多个CPU进行缓存，并且该缓存中的数据与主存数据是一致的，当有一个CPU修改该缓存行时，其他CPU是可以被作废的，变成I(无效的)
  I：Invalid 无效的，代表这个缓存是无效的，可能是有其他CPU修改了该缓存行

作者：Meet相识_bfa5
链接：https://www.jianshu.com/p/be923a7beb2c
來源：简书
简书著作权归作者所有，任何形式的转载都请联系作者获得授权并注明出处。

